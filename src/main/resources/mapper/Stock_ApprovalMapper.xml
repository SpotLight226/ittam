<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ittam.web.stock_approval.service.Stock_ApprovalMapper">
    <select id="getStockApprovalList">
        select * from STOCK_APPROVAL where appro_yn = 'N';
    </select>

    <update id="updateITStatus">
        update ITASSETS set assets_status = #{assets_status} where assets_num = #{assets_num}
    </update>

    <update id="ApprovY">
        update STOCK_APPROVAL set appro_yn = 'Y' , appro_okdate = now() where appro_num = #{appro_num}
    </update>

    <insert id="statusUpdate">
        insert into STOCK_APPROVAL(
            username, assets_num, category_num , appro_title, appro_date, appro_count, asset_seriel, appro_comment, appro_kind, appro_yn
        ) VALUES (
            #{username}, #{assets_num}, #{category_num} , #{appro_title}, now(), 1 , #{asset_seriel}, #{appro_comment}, #{appro_kind}, "N"
        )
    </insert>

    <update id="updateList">
        UPDATE ITASSETS
        SET APPRO_YN = 'Y'
        WHERE assets_num = (SELECT max_asset_num FROM (SELECT MAX(assets_num) AS max_asset_num FROM ITASSETS) AS tmp)

    </update>
</mapper>